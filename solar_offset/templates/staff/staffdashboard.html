<link rel="stylesheet" href="../static/css/homestyle.css">
<link rel="stylesheet" href="../static/css/staff.css">

{% extends 'base.html' %}
<!-- Title Section -->
{% block title %}Staff DashBoard{% endblock %}

<!-- Body Section -->
{% block body %}

    {% include 'flashmessage.html' %}
    <div class="text-center">
        <h2>Welcome to Solar Offset Staff DashBoard: {{ staffname }}</h2>         <!--add this variable to staff.py -->
    </div>
    <div class="container">
        <div class="left-section">
            <h1>esolaroffset</h1>
        </div>

        <div class="right-section">
            {% if countries %}
            <label for="country">Select Country:</label>
            <select id="country" onchange="updateOrganizations()"></select>

            <label for="organization">Select Organization:</label>
            <select id="organization"></select>

            <br>
            <button onclick="location.href='/staff/report'" class="btn btn-outline-success px-3">Generate</button>
            <button onclick="location.href='/staff/report'" class="btn btn-outline-success px-3">Export</button>
           

            <script>
                var countries = [
                    {% for country in countries %}
                    { 
                        "name": "{{ country.name }}", 
                        "organizations": [
                            {% for organization in country.organizations %}
                            "{{ organization }}",
                            {% endfor %}
                        ]
                    },
                    {% endfor %}
                ];
            
                function populateDropdown(selectId, options) {
                    var select = document.getElementById(selectId);
                    select.innerHTML = ""; // Clear existing options
            
                    for (var i = 0; i < options.length; i++) {
                        var option = document.createElement("option");
                        option.text = options[i];
                        option.value = options[i];
                        select.add(option);
                    }
                }
            
                function updateOrganizations() {
                    var countrySelect = document.getElementById("country");
                    var organizationSelect = document.getElementById("organization");
                    var selectedCountry = countrySelect.value;
            
                    // Find the selected country's organizations
                    var selectedCountryOrgs = countries.find(country => country.name === selectedCountry).organizations;
            
                    // Populate the organization dropdown with the organizations of the selected country
                    populateDropdown("organization", selectedCountryOrgs);
                }
            
                // Populate the country dropdown initially
                var countryNames = countries.map(country => country.name);
                populateDropdown("country", countryNames);
            
                // Update organizations when the country dropdown changes
                updateOrganizations();
            </script>
            
            {% endif %}
        </div>
    </div>
    <script src="{{ url_for('static', filename='jquery-3.3.1.slim.min.js') }}"></script>
    <script src="{{ url_for('static', filename='popper.min.js') }}"></script>
    <script src="{{ url_for('static', filename='bootstrap.min.js') }}"></script>
{% endblock %}
